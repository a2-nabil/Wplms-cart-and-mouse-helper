<?php
require_once get_stylesheet_directory() . '/members/dashboard/classes/UserProfile.php';
$profile_object = new UserProfile();
$current_user_data = $profile_object->getUserData();
$current_user_meta = $profile_object->getMetaValue();

// var_dump($current_user_meta);

global $wpdb;

// $start_time = microtime(true);

$user_vid = $_GET['userid'];

$user_id = $user_vid ? $user_vid : get_current_user_id();

//default query
$pageposts = $wpdb->get_results(apply_filters('wplms_usermeta_direct_query', $wpdb->prepare("
	SELECT posts.ID as id, IF(meta.meta_value > %d,'active','expired') as status
	FROM {$wpdb->posts} AS posts
	LEFT JOIN {$wpdb->usermeta} AS meta ON posts.ID = meta.meta_key
	WHERE   posts.post_type   = %s
	AND   posts.post_status   = %s
	AND   meta.user_id   = %d
	", time(), 'course', 'publish', $user_id)));


if ($pageposts) {

    $all_Courses = [];
    $active_Courses = [];
    $completed_Courses = [];

    $activeCount = 0;
    $continueCount = 0;
    $completedCount = 0;
    $startCount = 0;
    $evaluatedCount = 0;

    foreach ($pageposts as $allCourseId) {
        $all_Courses[] = $allCourseId->id;

        $status = bp_course_get_user_course_status($user_id, $allCourseId->id);
        if ($status == 1) {
            $startCount++;
            $active_Courses[] = $allCourseId->id;
        } elseif ($status == 2) {
            $continueCount++;
            $active_Courses[] = $allCourseId->id;
        } elseif ($status == 4) {
            $completedCount++;
            $completed_Courses[] = $allCourseId->id;
        } elseif ($status == 3) {
            $evaluatedCount++;
            $completed_Courses[] = $allCourseId->id;
        }
    }

    $totalCourse = count((array) $all_Courses);
    $activeCourses = ($continueCount + $startCount);
    $completedCourses = ($completedCount + $evaluatedCount);

    $userCertificates = bp_course_get_user_certificates($user_id);

    if (!empty($userCertificates)) {
        $countCertifiedCourse = count((array) $userCertificates);
    } else {
        $countCertifiedCourse = '0';
    }

    $pendingCertificate = $totalCourse - $countCertifiedCourse;
}


$wp_usermeta_data = get_user_meta($user_id);
// $wp_users_data = wp_get_current_user();
$wp_users_data = get_userdata($user_id);

$image_path = get_user_meta($user_id, 'user_image', true);
$image_path = $image_path != "" ? $image_path : get_stylesheet_directory_uri() . '/assets/dash/images/user.png';
$user_display_name = $wp_users_data->display_name;
$user_email = $wp_users_data->user_email;
$role = $wp_users_data->roles[0];

$fname = $wp_usermeta_data['first_name'][0] ?? '';
$lname = $wp_usermeta_data['last_name'][0] ?? '';
$fullname = ($fname != '' || $lname != '') ? $fname . ' ' . $lname : 'Set Name';
$name = $user_display_name ?? $fullname;

?>
<section>
    <!-- Dashboard Area Start  -->
    <div class="a2n-nxt_dashboard">
        <!-- Sidebar menu  -->
        <aside class="a2n-nxt_sidebar">
            <div class="a2n_nav-mobile a2n_dash__mobile">
                <a id="a2n_navbar-toggle" href="javascript:void(0)">
                    <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/dash-menu.svg"
                        alt="" />
                </a>
            </div>
            <div class="a2n-dash__logo">
                <a href="<?php echo home_url(); ?>">
                    <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/dash-logo.svg"
                        alt="" /></a>
            </div>
            <div id="a2n-dash__mobileLogo" class="a2n_dash__mobile">
                <a href="<?php echo home_url(); ?>">
                    <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/dash-mobileLogo.svg"
                        alt="" /></a>
            </div>
            <div id="a2n-dash__mobileSearch" class="a2n_dash__mobile">
                <a href="javascript:void(0)">
                    <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/dash-mobileSearch.svg"
                        alt="" /></a>
            </div>
            <ul id="a2n_nav-list">
                <div id="a2n-dash__mobileClose" class="a2n_dash__mobile">
                    <a href="javascript:void(0)">
                        <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/dash-cross.svg"
                            alt="" /></a>
                </div>
                <div>
                    <div class="a2n-sidebar_user a2n_user_box">
                        <div class="user_img">
                            <img class="onLoadProfilePic" src="<?php echo $image_path; ?>" alt="user" />
                        </div>
                        <div class="user_details">
                            <h4>Hello, <span class="displayName"><?php echo $name; ?></span></h4>
                        </div>
                    </div>
                    <li>
                        <a class="a2n_active" href="#my_dashboard">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M19.6875 3.30981H4.3125C3.58875 3.30981 3 3.89856 3 4.62231V6.49731C3 7.22106 3.58875 7.80981 4.3125 7.80981H19.6875C20.4112 7.80981 21 7.22106 21 6.49731V4.62231C21 3.89856 20.4112 3.30981 19.6875 3.30981Z"
                                    fill="white" />
                                <path
                                    d="M4.3125 21.3098H9.9375C10.6612 21.3098 11.25 20.7211 11.25 19.9973V10.6223C11.25 9.89856 10.6612 9.30981 9.9375 9.30981H4.3125C3.58875 9.30981 3 9.89856 3 10.6223V19.9973C3 20.7211 3.58875 21.3098 4.3125 21.3098Z"
                                    fill="white" />
                                <path
                                    d="M19.6875 9.30981H14.0625C13.3387 9.30981 12.75 9.89856 12.75 10.6223V13.2473C12.75 13.9711 13.3387 14.5598 14.0625 14.5598H19.6875C20.4112 14.5598 21 13.9711 21 13.2473V10.6223C21 9.89856 20.4112 9.30981 19.6875 9.30981Z"
                                    fill="white" />
                                <path
                                    d="M19.6875 16.0598H14.0625C13.3387 16.0598 12.75 16.6486 12.75 17.3723V19.9973C12.75 20.7211 13.3387 21.3098 14.0625 21.3098H19.6875C20.4112 21.3098 21 20.7211 21 19.9973V17.3723C21 16.6486 20.4112 16.0598 19.6875 16.0598Z"
                                    fill="white" />
                            </svg>
                            Dashboard</a>
                    </li>
                    <li>
                        <a href="#my_profile">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M12.3223 13.6147C13.6114 13.6147 14.8028 13.2515 15.7559 12.6343C16.4942 12.1616 17.4551 12.2397 18.1036 12.8296C19.9043 14.4624 20.9278 16.7788 20.9239 19.2124V20.2554C20.9239 21.3335 20.0489 22.2046 18.9707 22.2046H5.67387C4.59575 22.2046 3.72075 21.3335 3.72075 20.2554V19.2124C3.71294 16.7827 4.73637 14.4624 6.53715 12.8335C7.18559 12.2436 8.15044 12.1655 8.88481 12.6382C9.84184 13.2515 11.0293 13.6147 12.3223 13.6147Z"
                                    fill="white" />
                                <path
                                    d="M12.3223 11.8765C14.9931 11.8765 17.1582 9.71134 17.1582 7.04053C17.1582 4.36971 14.9931 2.20459 12.3223 2.20459C9.65145 2.20459 7.48633 4.36971 7.48633 7.04053C7.48633 9.71134 9.65145 11.8765 12.3223 11.8765Z"
                                    fill="white" />
                            </svg>
                            My Profile</a>
                    </li>
                    <li>
                        <a href="#my_courses">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M12.5629 17.2975H12.6406C12.739 17.2265 12.8475 17.1704 12.9624 17.1311H13.1066C13.1931 17.0903 13.2884 17.0713 13.384 17.0756H13.5282C13.6367 17.0402 13.7481 17.0143 13.8611 16.998H13.9388L14.3382 16.9425H14.4492H14.7265H20.4075V4.22681H15.4811C13.6427 4.22681 12.1523 5.71713 12.1523 7.55551L12.1967 17.5083C12.3111 17.4255 12.4338 17.3549 12.5629 17.2975Z"
                                    fill="white" />
                                <path
                                    d="M21.4172 6.49029V17.4195C21.4174 17.427 21.4174 17.4345 21.4172 17.4419C21.411 17.7177 21.1825 17.9361 20.9068 17.9299H15.481C12.6849 17.9299 12.1523 18.7399 12.1523 19.9604V20.2045C13.3396 19.2835 15.3479 19.2835 16.3798 19.2835H22.6045L22.6378 6.49023L21.4172 6.49029Z"
                                    fill="white" />
                                <path
                                    d="M8.54658 17.1755H8.81288H8.9571L9.36763 17.231H9.44528L9.77815 17.3086H9.92238C10.017 17.3139 10.1104 17.3325 10.1998 17.3641H10.344L10.6658 17.5306H10.7434C10.8606 17.609 10.9829 17.6794 11.1096 17.7414V7.55551C11.1096 5.71713 9.61926 4.22681 7.78087 4.22681H2.85449V17.1755H8.54658Z"
                                    fill="white" />
                                <path
                                    d="M7.78074 17.9633H2.35495C2.07789 17.952 1.85585 17.73 1.84457 17.4529V6.49036H0.624023V19.2615H6.80434C7.91389 19.2615 9.93332 19.2615 11.1206 20.2046L11.1095 19.9938C11.1095 18.7733 10.5546 17.9633 7.78074 17.9633Z"
                                    fill="white" />
                            </svg>
                            My Courses</a>
                    </li>


                    <li>
                        <a href="#my_certificates">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M15.4271 16.6227L16.4331 14.9902L18.2486 14.371L18.4498 12.4642L19.8157 11.1195L19.1663 9.31457L19.8157 7.50958L18.4498 6.16488L18.2487 4.25811L16.4332 3.63893L15.4271 2.00643L13.5243 2.23618L11.9079 1.20459L10.2914 2.23627L8.3886 2.00651L7.38257 3.63897L5.56706 4.25815L5.36593 6.16493L4 7.50963L4.64943 9.31461L4 11.1196L5.36589 12.4642L5.56702 14.3711L7.38253 14.9902L8.38855 16.6227L10.2914 16.393L11.9079 17.4246L13.5243 16.393L15.4271 16.6227ZM6.34647 9.31461C6.34647 6.24807 8.84131 3.75323 11.9079 3.75323C14.9744 3.75323 17.4692 6.24807 17.4692 9.31461C17.4692 12.3811 14.9744 14.876 11.9079 14.876C8.84131 14.876 6.34647 12.3811 6.34647 9.31461Z"
                                    fill="white" />
                                <path
                                    d="M11.9072 5.04309C9.55193 5.04309 7.63574 6.95927 7.63574 9.3146C7.63574 11.6699 9.55193 13.5861 11.9072 13.5861C14.2626 13.5861 16.1788 11.6699 16.1788 9.3146C16.1788 6.95927 14.2626 5.04309 11.9072 5.04309Z"
                                    fill="white" />
                                <path
                                    d="M9.98696 17.7289L7.72338 18.0022L6.52743 16.0615L6.12086 15.9229L4.36719 21.4042L7.5243 21.2305L9.99435 23.2045L11.4479 18.6614L9.98696 17.7289Z"
                                    fill="white" />
                                <path
                                    d="M17.2886 16.0615L16.0926 18.0022L13.8291 17.7289L12.3682 18.6614L13.8217 23.2045L16.2918 21.2305L19.4489 21.4042L17.6952 15.9229L17.2886 16.0615Z"
                                    fill="white" />
                            </svg> My Certificates</a>
                    </li>
                    <li>
                        <a href="#my_learning">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M12.3115 3.93583C12.4773 3.93583 12.6113 3.80189 12.6113 3.63606V2.50436C12.6113 2.33853 12.4773 2.20459 12.3115 2.20459C12.1457 2.20459 12.0117 2.33853 12.0117 2.50436V3.63606C12.0117 3.80163 12.1457 3.93583 12.3115 3.93583Z"
                                    fill="white" />
                                <path
                                    d="M9.38926 4.49836C9.4448 4.59477 9.54557 4.64901 9.6497 4.64901C9.70034 4.64901 9.75176 4.6359 9.79881 4.60916C9.94252 4.52638 9.99162 4.34308 9.90936 4.19962L9.34607 3.22011C9.26329 3.07691 9.07999 3.02729 8.93653 3.10956C8.79282 3.19234 8.74371 3.37565 8.82598 3.5191L9.38926 4.49836Z"
                                    fill="white" />
                                <path
                                    d="M6.57319 5.99272L7.5527 6.556C7.60001 6.583 7.65117 6.59585 7.70182 6.59585C7.80594 6.59585 7.90672 6.54186 7.96225 6.4452C8.04452 6.30148 7.99541 6.11818 7.8517 6.03565L6.87219 5.47237C6.72822 5.39062 6.54517 5.43972 6.46264 5.58292C6.38038 5.72663 6.42974 5.90994 6.57319 5.99272Z"
                                    fill="white" />
                                <path
                                    d="M16.9224 6.59594C16.973 6.59594 17.0244 6.58283 17.0715 6.55609L18.051 5.99281C18.1947 5.91003 18.2438 5.72672 18.1615 5.58327C18.0787 5.44007 17.8954 5.39045 17.752 5.47272L16.7725 6.036C16.6288 6.11879 16.5797 6.30209 16.6619 6.44555C16.7172 6.54195 16.8182 6.59594 16.9224 6.59594Z"
                                    fill="white" />
                                <path
                                    d="M14.8253 4.60888C14.8726 4.63588 14.9238 4.64873 14.9744 4.64873C15.0785 4.64873 15.1793 4.59474 15.2349 4.49808L15.7981 3.51857C15.8804 3.37486 15.8313 3.19155 15.6876 3.10903C15.5439 3.02701 15.3606 3.07663 15.278 3.21957L14.7148 4.19908C14.6322 4.34305 14.6816 4.5261 14.8253 4.60888Z"
                                    fill="white" />
                                <path
                                    d="M9.87102 11.7552C10.2168 12.0586 10.4672 12.436 10.6048 12.8525H14.0197C14.1572 12.4363 14.4043 12.0589 14.7429 11.766C15.6776 10.9547 16.1468 9.73401 15.9987 8.49921C15.9777 8.31231 15.9388 8.13235 15.8895 7.95598C15.8895 7.95598 15.8895 7.95598 15.8859 7.95598V7.95238C15.4871 6.53068 14.2418 5.44062 12.7496 5.2712C12.6016 5.25346 12.4532 5.24292 12.3087 5.24292C11.3914 5.24292 10.5307 5.57097 9.8394 6.18849C9.04911 6.89061 8.59766 7.90302 8.59766 8.95786C8.59766 10.0302 9.06325 11.0498 9.87102 11.7552ZM11.1799 8.38275C11.4375 8.38275 11.6701 8.48867 11.8396 8.65784C12.009 8.82726 12.1146 9.05992 12.1146 9.32113V9.65637H12.5098V9.32113C12.5098 8.80258 12.926 8.38275 13.4412 8.38275C13.9598 8.38275 14.376 8.80258 14.376 9.32113C14.376 9.57873 14.2737 9.8114 14.1043 9.98082C13.9348 10.1502 13.7022 10.2559 13.441 10.2559H13.1093V11.9033C13.1093 12.0692 12.9754 12.2031 12.8095 12.2031C12.6437 12.2031 12.5098 12.0692 12.5098 11.9033V10.2559H12.1146V11.9033C12.1146 12.0692 11.9807 12.2031 11.8149 12.2031C11.649 12.2031 11.5151 12.0692 11.5151 11.9033V10.2559H11.1835C11.1799 10.2559 11.1799 10.2559 11.1799 10.2559C10.6649 10.2559 10.2484 9.83608 10.2484 9.32113C10.2487 8.80258 10.6649 8.38275 11.1799 8.38275Z"
                                    fill="white" />
                                <path
                                    d="M13.7763 9.32101C13.7763 9.1341 13.6282 8.98242 13.441 8.98242C13.2575 8.98242 13.1094 9.1341 13.1094 9.32101V9.65625H13.4446C13.6279 9.65265 13.7763 9.50457 13.7763 9.32101Z"
                                    fill="white" />
                                <path
                                    d="M11.1793 9.65638H11.5145V9.32113C11.5145 9.13423 11.3665 8.98254 11.1793 8.98254C10.996 8.98254 10.8477 9.13423 10.8477 9.32113C10.8477 9.50469 10.996 9.65638 11.1793 9.65638Z"
                                    fill="white" />
                                <path
                                    d="M10.876 14.4788C10.8971 14.4965 10.9572 14.5564 11.13 14.5564H13.4937C13.6772 14.5564 13.7654 14.4929 13.8253 14.3271C13.8958 14.126 13.8958 13.8402 13.8958 13.6108C13.8958 13.5579 13.9027 13.5049 13.9063 13.4486H10.7207C10.7207 13.498 10.7276 13.5473 10.7276 13.5967V13.6425C10.7279 13.9319 10.7279 14.3271 10.876 14.4788Z"
                                    fill="white" />
                                <path
                                    d="M12.3115 15.6712C12.6536 15.6712 12.9501 15.4596 13.0665 15.1562H11.5566C11.6728 15.4596 11.9693 15.6712 12.3115 15.6712Z"
                                    fill="white" />
                                <path
                                    d="M21.5473 10.2489V18.2323C21.5473 18.3135 21.5121 18.3945 21.4519 18.4511C21.392 18.5076 21.3144 18.5357 21.2298 18.5323C20.2138 18.4724 18.0442 18.5146 16.358 19.0403C15.2468 19.3897 14.2061 19.8977 13.25 20.5538H22.5952V10.2489H21.5473Z"
                                    fill="white" />
                                <path
                                    d="M15.1372 12.2174C14.7279 12.5702 14.4953 13.0712 14.4953 13.5934C14.4953 13.8862 14.4953 14.2284 14.3894 14.5248C14.2693 14.867 14.0261 15.0752 13.6978 15.1351C13.5885 15.6856 13.1582 16.1193 12.6113 16.2393V20.2682C13.7014 19.4745 14.8974 18.8711 16.1815 18.4691C17.7868 17.9647 19.7975 17.8834 20.9477 17.9186V7.58879C19.9001 7.54997 18.0619 7.62041 16.5345 8.06492C16.5592 8.18498 16.5803 8.30478 16.5944 8.42484C16.7636 9.86094 16.2203 11.279 15.1372 12.2174ZM17.6351 8.65777H18.7676C18.9334 8.65777 19.0674 8.79171 19.0674 8.95753C19.0674 9.12336 18.9334 9.2573 18.7676 9.2573H17.6351C17.4693 9.2573 17.3351 9.12336 17.3351 8.95753C17.3351 8.79197 17.4693 8.65777 17.6351 8.65777ZM17.0705 11.36L18.0513 11.9246C18.1925 12.0058 18.2418 12.1891 18.1606 12.3339C18.104 12.429 18.0053 12.4856 17.8997 12.4856C17.8503 12.4856 17.7973 12.4714 17.7513 12.4431L16.7705 11.8822C16.6294 11.7976 16.58 11.614 16.6613 11.4729C16.7425 11.3284 16.9261 11.279 17.0705 11.36Z"
                                    fill="white" />
                                <path
                                    d="M8.44556 18.4686C9.72972 18.8707 10.9257 19.4741 12.0122 20.2677V16.2391C11.4653 16.1191 11.0386 15.6887 10.9257 15.1385C10.7388 15.1069 10.5799 15.0293 10.4529 14.9023C10.1285 14.5742 10.1285 14.0343 10.1285 13.6428V13.597C10.1285 13.0749 9.8922 12.5705 9.47571 12.2069C8.53734 11.3884 7.99745 10.2032 7.99745 8.95784C7.99745 8.65447 8.02907 8.35445 8.09257 8.06188C6.56495 7.62097 4.6918 7.55387 3.67578 7.58909V17.9184C4.826 17.8832 6.84029 17.9642 8.44556 18.4686ZM7.96223 11.4732C8.04347 11.6143 7.99411 11.7976 7.85297 11.8825L6.87217 12.4435C6.82641 12.4717 6.77345 12.4859 6.72409 12.4859C6.61817 12.4859 6.51944 12.4293 6.46314 12.3342C6.3819 12.1894 6.43152 12.0061 6.5724 11.9249L7.5532 11.3603C7.69743 11.2791 7.88099 11.3285 7.96223 11.4732ZM5.85615 8.65781H6.98863C7.15446 8.65781 7.2884 8.79176 7.2884 8.95758C7.2884 9.1234 7.15446 9.25735 6.98863 9.25735H5.85615C5.69033 9.25735 5.55639 9.1234 5.55639 8.95758C5.55613 8.79201 5.69033 8.65781 5.85615 8.65781Z"
                                    fill="white" />
                                <path
                                    d="M8.26849 19.0401C6.58224 18.511 4.40907 18.4722 3.39305 18.5321C3.31901 18.539 3.23083 18.5074 3.17093 18.4508C3.11102 18.3943 3.07555 18.3133 3.07555 18.232V10.2489H2.03125V20.5536H11.3731C10.417 19.8975 9.37629 19.3895 8.26849 19.0401Z"
                                    fill="white" />
                                <path
                                    d="M12.4001 21.1639C12.3718 21.1708 12.3402 21.178 12.3119 21.178C12.2767 21.178 12.2378 21.1675 12.206 21.1533H2.02832V22.2046H22.5955V21.1533H12.4178C12.4106 21.1569 12.4073 21.1603 12.4001 21.1639Z"
                                    fill="white" />
                            </svg>
                            Unlimited Learning</a>
                    </li>
                    <li>
                        <a href="#my_offers">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M14.0043 2.92125C12.883 1.9657 11.2338 1.9657 10.1126 2.92125L9.42995 3.50297C8.94946 3.91244 8.35204 4.1599 7.72274 4.21011L6.82872 4.28146C5.36019 4.39865 4.19406 5.56478 4.07687 7.03331L4.00552 7.92733C3.95531 8.55663 3.70785 9.15405 3.29838 9.63454L2.71666 10.3172C1.76111 11.4384 1.76111 13.0876 2.71666 14.2089L3.29838 14.8915C3.70785 15.372 3.95531 15.9694 4.00552 16.5987L4.07687 17.4927C4.19406 18.9612 5.36019 20.1274 6.82872 20.2445L7.72274 20.3159C8.35204 20.3661 8.94946 20.6136 9.42995 21.023L10.1126 21.6048C11.2338 22.5603 12.883 22.5603 14.0043 21.6048L14.6869 21.023C15.1674 20.6136 15.7648 20.3661 16.3941 20.3159L17.2881 20.2445C18.7566 20.1274 19.9228 18.9612 20.04 17.4927L20.1113 16.5987C20.1615 15.9694 20.409 15.372 20.8185 14.8915L21.4002 14.2089C22.3557 13.0876 22.3557 11.4384 21.4002 10.3172L20.8185 9.63454C20.409 9.15405 20.1615 8.55663 20.1113 7.92733L20.04 7.03331C19.9228 5.56478 18.7566 4.39865 17.2881 4.28146L16.3941 4.21011C15.7648 4.1599 15.1674 3.91244 14.6869 3.50297L14.0043 2.92125ZM9.05841 10.263C9.6107 10.263 10.0584 9.81529 10.0584 9.263C10.0584 8.71072 9.6107 8.263 9.05841 8.263C8.50613 8.263 8.05841 8.71072 8.05841 9.263C8.05841 9.81529 8.50613 10.263 9.05841 10.263ZM16.0584 15.263C16.0584 15.8153 15.6107 16.263 15.0584 16.263C14.5061 16.263 14.0584 15.8153 14.0584 15.263C14.0584 14.7107 14.5061 14.263 15.0584 14.263C15.6107 14.263 16.0584 14.7107 16.0584 15.263ZM15.5887 9.79333C15.8816 9.50044 15.8816 9.02557 15.5887 8.73267C15.2958 8.43978 14.821 8.43978 14.5281 8.73267L8.52808 14.7327C8.23519 15.0256 8.23519 15.5004 8.52808 15.7933C8.82098 16.0862 9.29585 16.0862 9.58874 15.7933L15.5887 9.79333Z"
                                    fill="white" />
                            </svg>
                            Special Offers</a>
                    </li>
                    <li>
                        <a href="#my_orders">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M8.72727 8.03792C9.17726 8.03792 9.54545 7.66292 9.54545 7.20459V6.37126C9.54545 4.98792 10.6418 3.87126 12 3.87126C13.3582 3.87126 14.4545 4.98792 14.4545 6.37126V7.20459C14.4545 7.66292 14.8227 8.03792 15.2727 8.03792C15.7227 8.03792 16.0909 7.66292 16.0909 7.20459V6.37126C16.0909 4.07126 14.2582 2.20459 12 2.20459C9.74181 2.20459 7.90908 4.07126 7.90908 6.37126V7.20459C7.90908 7.66292 8.27727 8.03792 8.72727 8.03792ZM12 14.7046C9.74181 14.7046 7.90908 12.8379 7.90908 10.5379C7.90908 10.0796 8.27727 9.70459 8.72727 9.70459C9.17726 9.70459 9.54545 10.0796 9.54545 10.5379C9.54545 11.9213 10.6418 13.0379 12 13.0379C13.3582 13.0379 14.4545 11.9213 14.4545 10.5379C14.4545 10.0796 14.8227 9.70459 15.2727 9.70459C15.7227 9.70459 16.0909 10.0796 16.0909 10.5379C16.0909 12.8379 14.2582 14.7046 12 14.7046ZM21 17.1213L20.1818 8.87126C20.1818 7.48792 19.0854 6.37126 17.7273 6.37126H6.27272C4.94727 6.36292 3.85909 7.43792 3.81818 8.78792L3 17.2046C3 19.9629 5.20091 22.2046 7.90908 22.2046H16.0909C18.8154 22.1963 21.0082 19.9379 21 17.1629C21 17.1546 21 17.1379 21 17.1213Z"
                                    fill="white" />
                            </svg>
                            My Orders</a>
                    </li>
                    <li>
                        <a href="#my_student_card">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M15.856 2.77602H8.144C8.30905 2.31752 8.61446 1.92037 9.01835 1.63904C9.42224 1.35771 9.90484 1.20596 10.4 1.20459H13.6C14.0952 1.20596 14.5778 1.35771 14.9817 1.63904C15.3855 1.92037 15.6909 2.31752 15.856 2.77602ZM12 15.151C11.1843 15.152 10.393 15.4244 9.75517 15.9238C9.11735 16.4233 8.67068 17.1202 8.488 17.901H15.512C15.3293 17.1202 14.8826 16.4233 14.2448 15.9238C13.607 15.4244 12.8157 15.152 12 15.151ZM12 13.5796C12.3956 13.5796 12.7822 13.4644 13.1111 13.2485C13.44 13.0327 13.6964 12.7259 13.8478 12.367C13.9991 12.0081 14.0387 11.6131 13.9616 11.2321C13.8844 10.8511 13.6939 10.5011 13.4142 10.2263C13.1345 9.95163 12.7781 9.76455 12.3902 9.68876C12.0022 9.61297 11.6001 9.65187 11.2346 9.80054C10.8692 9.94921 10.5568 10.201 10.3371 10.524C10.1173 10.847 10 11.2268 10 11.6153C10 12.1363 10.2107 12.6359 10.5858 13.0043C10.9609 13.3726 11.4696 13.5796 12 13.5796ZM20 6.70459V20.8474C20 21.4726 19.7471 22.0721 19.2971 22.5142C18.847 22.9562 18.2365 23.2046 17.6 23.2046H6.4C5.76348 23.2046 5.15303 22.9562 4.70294 22.5142C4.25286 22.0721 4 21.4726 4 20.8474V6.70459C4 6.07944 4.25286 5.47989 4.70294 5.03784C5.15303 4.59579 5.76348 4.34745 6.4 4.34745H17.6C18.2365 4.34745 18.847 4.59579 19.2971 5.03784C19.7471 5.47989 20 6.07944 20 6.70459ZM17.2 18.6867C17.1984 17.763 16.9425 16.857 16.4594 16.0644C15.9764 15.2719 15.2842 14.6223 14.456 14.1846C14.9843 13.7004 15.3521 13.0713 15.5114 12.379C15.6707 11.6867 15.6142 10.9634 15.3493 10.3031C15.0844 9.64283 14.6232 9.07612 14.0259 8.67673C13.4285 8.27734 12.7226 8.06376 12 8.06376C11.2774 8.06376 10.5715 8.27734 9.97413 8.67673C9.37678 9.07612 8.91564 9.64283 8.6507 10.3031C8.38575 10.9634 8.32927 11.6867 8.48859 12.379C8.64791 13.0713 9.01566 13.7004 9.544 14.1846C8.71584 14.6223 8.0236 15.2719 7.54055 16.0644C7.05751 16.857 6.80163 17.763 6.8 18.6867C6.8 18.8951 6.88429 19.095 7.03431 19.2423C7.18434 19.3897 7.38783 19.4724 7.6 19.4724H16.4C16.6122 19.4724 16.8157 19.3897 16.9657 19.2423C17.1157 19.095 17.2 18.8951 17.2 18.6867Z"
                                    fill="white" />
                            </svg>
                            Student ID Card</a>
                    </li>
                    <li>
                        <a href="#my_support">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M12.2701 3.20939C10.503 3.15054 8.71764 3.63265 7.17626 4.66153C5.44508 5.81832 4.23524 7.52657 3.67798 9.43623C3.52409 9.41745 3.33981 9.42573 3.12099 9.48762C2.30403 9.71942 1.68958 10.3889 1.4133 10.9784C1.05496 11.7468 0.903831 12.7629 1.06325 13.812C1.22156 14.8577 1.66333 15.7197 2.21589 16.2549C2.77012 16.7903 3.3959 16.9644 4.01753 16.8337C4.94307 16.6361 5.40198 16.4883 5.2724 15.6261L4.64497 11.4462C4.7715 9.18399 5.94266 7.05441 7.9015 5.74483C10.5234 3.99348 13.9609 4.10565 16.4618 6.02553C18.2016 7.35942 19.2117 9.35805 19.3282 11.4561L18.8895 14.38C17.9109 17.058 15.4849 18.913 12.6776 19.1763H10.8083C10.3259 19.1763 9.93742 19.5647 9.93742 20.0466V20.5057C9.93742 20.9879 10.3259 21.3763 10.8083 21.3763H13.1652C13.6473 21.3763 14.0341 20.9879 14.0341 20.5057V20.2657C16.151 19.749 17.9988 18.448 19.202 16.6337L19.9571 16.834C20.5715 16.9934 21.2048 16.7903 21.7587 16.2551C22.3113 15.7197 22.7528 14.858 22.9114 13.8123C23.0713 12.7632 22.9158 11.7487 22.5616 10.9787C22.206 10.2087 21.6764 9.7197 21.065 9.54426C20.8088 9.47049 20.5309 9.44342 20.2925 9.43623C19.7885 7.70947 18.7511 6.13908 17.2559 4.99251C15.7858 3.86445 14.0372 3.26741 12.2701 3.20939Z"
                                    fill="white" />
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M15.0288 10.7293C15.6518 10.7293 16.1569 11.2343 16.1582 11.859C16.1569 12.482 15.6518 12.9884 15.0288 12.9884C14.4041 12.9884 13.8977 12.482 13.8977 11.859C13.8977 11.2346 14.4044 10.7293 15.0288 10.7293ZM11.9869 10.7293C12.6113 10.7293 13.1164 11.2343 13.1164 11.859C13.1164 12.482 12.6113 12.9884 11.9869 12.9884C11.362 12.9884 10.8569 12.482 10.8569 11.859C10.8569 11.2346 11.362 10.7293 11.9869 10.7293ZM8.94618 10.7293C9.5692 10.7293 10.0756 11.2343 10.0756 11.859C10.0756 12.482 9.5692 12.9884 8.94618 12.9884C8.32178 12.9884 7.81646 12.482 7.81646 11.859C7.81646 11.2346 8.32178 10.7293 8.94618 10.7293ZM11.9869 5.8772C8.67432 5.8772 6.00488 8.45878 6.00488 11.859C6.00488 13.4921 6.62237 14.9354 7.62832 15.9944L7.27136 17.5946C7.15366 18.1212 7.51891 18.4754 7.99218 18.2118L9.55483 17.3401C10.2975 17.6626 11.1189 17.8408 11.9869 17.8408C15.3007 17.8408 17.9684 15.2608 17.9684 11.859C17.9684 8.45878 15.3007 5.8772 11.9869 5.8772Z"
                                    fill="white" />
                            </svg>
                            Support</a>
                    </li>
                </div>
                <div>
                    <li>
                        <a id="logout" href="<?php echo wp_logout_url(home_url()); ?>">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25"
                                fill="none">
                                <path
                                    d="M11.6186 14.1083C12.6338 14.1083 13.4597 13.2823 13.4597 12.2671V4.73587C13.4597 3.72071 12.6338 2.89478 11.6186 2.89478C10.6033 2.89478 9.77734 3.72071 9.77734 4.73591V12.2672C9.77734 13.2824 10.6033 14.1083 11.6186 14.1083Z"
                                    fill="white" />
                                <path
                                    d="M17.8162 7.98067C17.8115 7.97556 17.8067 7.9706 17.8023 7.96618C17.4546 7.61849 16.9922 7.427 16.5005 7.427C16.0087 7.427 15.5464 7.61845 15.1986 7.96618C14.8508 8.31392 14.6593 8.7763 14.6594 9.26813C14.6594 9.752 14.8448 10.2074 15.1821 10.5531C15.1874 10.5589 15.1929 10.5646 15.1986 10.5702C16.1547 11.5264 16.6812 12.7977 16.6812 14.15C16.6812 16.9415 14.4102 19.2125 11.6188 19.2125C8.8273 19.2125 6.55625 16.9415 6.55625 14.15C6.55625 12.7976 7.08281 11.5263 8.03902 10.5702C8.75672 9.85247 8.7568 8.68446 8.03887 7.9663C7.69109 7.61868 7.22871 7.4272 6.73703 7.4272C6.24527 7.4272 5.78297 7.61868 5.43523 7.96646C3.78359 9.61813 2.87402 11.8142 2.87402 14.15C2.87402 16.4858 3.78359 18.6818 5.43527 20.3335C7.08695 21.9852 9.28293 22.8948 11.6188 22.8948C13.9546 22.8948 16.1505 21.9852 17.8022 20.3335C19.4539 18.6818 20.3635 16.4858 20.3635 14.15C20.3635 11.8211 19.459 9.63067 17.8162 7.98067Z"
                                    fill="white" />
                            </svg>
                            Logout</a>
                    </li>
                </div>
            </ul>
        </aside>
        <!-- All tabs container  -->
        <main class="a2n-dash_container">
            <!-- top nav start -->
            <nav class="a2n_top_nav">
                <div class="a2n-top__search" id="a2n-search-suggestion">
                    <form class="a2n-search__container" role="search" action="<?php echo site_url(); ?>/" method="get">
                        <input type="text" name="s" id="course-search" class="nxt_searchField"
                            placeholder="Search here... ">
                        <button class="top_btn_search">
                            <img src="<?php echo get_stylesheet_directory_uri(); ?>/assets/dash/images/dashboard/search 3.svg"
                                alt="search" />
                        </button>
                        <input type="hidden" name="post_type" value="course" />
                    </form>
                </div>
                <div class="a2n-top__end">
                    <ul class="a2n-icon__list">
                        <!-- <li><a class="icon_box notification_box" href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none">
                                    <path
                                        d="M4.45549 13.88L3.88393 13.3944H3.88393L4.45549 13.88ZM5.33476 11.8385L4.58953 11.7541L5.33476 11.8385ZM18.6652 11.8385L19.4105 11.7541L18.6652 11.8385ZM19.5445 13.88L20.1161 13.3944L19.5445 13.88ZM18.3204 8.79403L17.5751 8.87846V8.87846L18.3204 8.79403ZM5.67964 8.79403L6.42487 8.87846L5.67964 8.79403ZM15.7023 19.2632C15.8477 18.8753 15.6511 18.4431 15.2632 18.2977C14.8753 18.1523 14.4431 18.3489 14.2977 18.7368L15.7023 19.2632ZM9.7023 18.7368C9.55694 18.3489 9.12467 18.1523 8.7368 18.2977C8.34893 18.4431 8.15234 18.8753 8.2977 19.2632L9.7023 18.7368ZM18.1699 16.25H5.83014V17.75H18.1699V16.25ZM17.5751 8.87846L17.92 11.9229L19.4105 11.7541L19.0656 8.70961L17.5751 8.87846ZM6.07999 11.9229L6.42487 8.87846L4.9344 8.70961L4.58953 11.7541L6.07999 11.9229ZM5.02706 14.3657C5.61173 13.6775 5.97775 12.8255 6.07999 11.9229L4.58953 11.7541C4.52038 12.3645 4.2732 12.9363 3.88393 13.3944L5.02706 14.3657ZM17.92 11.9229C18.0223 12.8255 18.3883 13.6775 18.9729 14.3657L20.1161 13.3944C19.7268 12.9363 19.4796 12.3645 19.4105 11.7541L17.92 11.9229ZM5.83014 16.25C4.94335 16.25 4.37926 15.1281 5.02706 14.3657L3.88393 13.3944C2.46491 15.0647 3.57828 17.75 5.83014 17.75V16.25ZM18.1699 17.75C20.4217 17.75 21.5351 15.0647 20.1161 13.3944L18.9729 14.3657C19.6207 15.1281 19.0567 16.25 18.1699 16.25V17.75ZM19.0656 8.70961C18.6504 5.04473 15.6279 2.25 12 2.25V3.75C14.8302 3.75 17.2419 5.93698 17.5751 8.87846L19.0656 8.70961ZM6.42487 8.87846C6.75808 5.93698 9.16977 3.75 12 3.75V2.25C8.37212 2.25 5.34956 5.04473 4.9344 8.70961L6.42487 8.87846ZM14.2977 18.7368C13.975 19.5979 13.0846 20.25 12 20.25V21.75C13.6855 21.75 15.1516 20.7325 15.7023 19.2632L14.2977 18.7368ZM12 20.25C10.9154 20.25 10.025 19.5979 9.7023 18.7368L8.2977 19.2632C8.84835 20.7325 10.3145 21.75 12 21.75V20.25Z"
                                        fill="#5CAF01" />
                                </svg>
                                <span class="a2n_tip">62</span>
                            </a></li> -->
                        <li><a class="icon_box cart_box" href="<?php echo site_url(); ?>/cart/" target="blank">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none">
                                    <path
                                        d="M10.0097 22C8.88487 22 7.96973 21.0848 7.96973 19.96C7.96973 18.8352 8.88487 17.9204 10.0097 17.9204C11.1345 17.9204 12.0496 18.8352 12.0496 19.96C12.0496 21.0848 11.1345 22 10.0097 22ZM10.0097 19.2008C9.59099 19.2008 9.2501 19.5414 9.2501 19.96C9.2501 20.379 9.59067 20.7196 10.0097 20.7196C10.4287 20.7196 10.7693 20.379 10.7693 19.96C10.7693 19.5414 10.4287 19.2008 10.0097 19.2008Z"
                                        fill="#5CAF01" />
                                    <path
                                        d="M17.1012 22C15.9763 22 15.0615 21.0848 15.0615 19.96C15.0615 18.8352 15.9763 17.9204 17.1012 17.9204C18.226 17.9204 19.1411 18.8352 19.1411 19.96C19.1411 21.0848 18.2256 22 17.1012 22ZM17.1012 19.2008C16.6825 19.2008 16.3419 19.5414 16.3419 19.96C16.3419 20.379 16.6825 20.7196 17.1012 20.7196C17.5202 20.7196 17.8607 20.379 17.8607 19.96C17.8607 19.5414 17.5198 19.2008 17.1012 19.2008Z"
                                        fill="#5CAF01" />
                                    <path
                                        d="M18.5949 16.3392H8.53788C7.55936 16.3392 6.7236 15.6731 6.5053 14.7192L4.41798 5.60395C4.39045 5.48359 4.30722 5.38053 4.19519 5.32867L2.46381 4.5262C2.06306 4.34055 1.88861 3.86489 2.07426 3.46381C2.25991 3.06306 2.73589 2.88861 3.13665 3.07426L4.86803 3.87673C5.42595 4.13505 5.84111 4.64719 5.97811 5.24673L8.06543 14.3626C8.116 14.5841 8.3103 14.7391 8.53788 14.7391H18.5949C18.8215 14.7391 19.0155 14.5851 19.0673 14.3642L20.6902 7.38206C20.7366 7.1836 20.6521 7.03924 20.598 6.97106C20.5436 6.90256 20.422 6.78797 20.2184 6.78797H8.37496C7.93291 6.78797 7.57473 6.42979 7.57473 5.98774C7.57473 5.54569 7.93291 5.18751 8.37496 5.18751H20.2184C20.8582 5.18751 21.453 5.47463 21.8512 5.97558C22.2494 6.47652 22.394 7.12119 22.2494 7.74441L20.6262 14.7269C20.405 15.676 19.5699 16.3392 18.5949 16.3392Z"
                                        fill="#5CAF01" />
                                </svg>
                                <?php
                                if (class_exists('WooCommerce')) {
                                    $cart_count = WC()->cart->get_cart_contents_count();
                                    if ($cart_count > 0) {
                                        $items .= '<span class="a2n_tip">' . $cart_count . '</span>';
                                    }

                                    echo $items;
                                } ?>
                            </a></li>
                        <li><a class="icon_box support_box" href="<?php echo site_url(); ?>/contact/" target="blank">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none">
                                    <path
                                        d="M12.5 2C7.24936 2 3 6.24888 3 11.5C3 16.7506 7.24888 21 12.5 21C17.7506 21 22 16.7511 22 11.5C22 6.24936 17.7511 2 12.5 2ZM12.5 19.6744C7.99262 19.6744 4.32558 16.0074 4.32558 11.5C4.32558 6.99258 7.99262 3.32558 12.5 3.32558C17.0074 3.32558 20.6744 6.99258 20.6744 11.5C20.6744 16.0074 17.0074 19.6744 12.5 19.6744Z"
                                        fill="#5CAF01" />
                                    <path
                                        d="M12.2189 14.0206C11.6937 14.0206 11.2686 14.4583 11.2686 14.9835C11.2686 15.4962 11.6812 15.9464 12.2189 15.9464C12.7566 15.9464 13.1818 15.4962 13.1818 14.9835C13.1818 14.4583 12.7441 14.0206 12.2189 14.0206Z"
                                        fill="#5CAF01" />
                                    <path
                                        d="M12.3814 6.73022C10.6933 6.73022 9.91797 7.73066 9.91797 8.4059C9.91797 8.89359 10.3306 9.1187 10.6682 9.1187C11.3435 9.1187 11.0684 8.15578 12.3439 8.15578C12.9691 8.15578 13.4694 8.43091 13.4694 9.00614C13.4694 9.68138 12.7691 10.069 12.3564 10.4192C11.9938 10.7317 11.5186 11.2445 11.5186 12.3199C11.5186 12.9701 11.6937 13.1577 12.2064 13.1577C12.8191 13.1577 12.9441 12.8826 12.9441 12.645C12.9441 11.9947 12.9566 11.6196 13.6444 11.0819C13.982 10.8193 15.0449 9.96895 15.0449 8.79351C15.0449 7.61807 13.982 6.73022 12.3814 6.73022Z"
                                        fill="#5CAF01" />
                                </svg>
                            </a></li>
                    </ul>
                </div>
            </nav>
            <!-- top nav end -->

            <!-- Dashboard Tab start  -->
            <?php include get_stylesheet_directory() . '/members/dashboard/includes/dashboard.php';
            ?>
            <!-- Dashboard Tab End  -->

            <!-- Profile Tab Start  -->
            <?php include get_stylesheet_directory() . '/members/dashboard/includes/profile.php';
            ?>
            <!-- Profile Tab End  -->

            <!-- My courses Tab Start  -->
            <?php include get_stylesheet_directory() . '/members/dashboard/includes/courses.php';
            ?>
            <!-- My courses Tab End  -->

            <!-- My certificates Tab Start  -->
            <?php include get_stylesheet_directory() . '/members/dashboard/includes/certificates.php';
            ?>
            <!-- My certificates Tab End  -->

            <!-- Unlimited learning Tab Start  -->
            <div id="my_learning" class="a2n_dash_tabs">
                <div class="a2n-welcome__wrapper">
                    <h2>Unlimited Learning</h2>
                </div>
                <?php echo do_shortcode('[elementor-template id="537960"]'); ?>
            </div>
            <!-- Unlimited learning Tab End  -->

            <!-- Special Offers Tab Start  -->
            <div id="my_offers" class="a2n_dash_tabs">
                <div class="a2n-welcome__wrapper">
                    <h2>Get Special Offers!</h2>
                </div>
                <?php echo do_shortcode('[elementor-template id="522548"]'); ?>
            </div>
            <!-- Special Offers Tab End  -->

            <!-- Orders Tab Start  -->
            <div id="my_orders" class="a2n_dash_tabs">
                <div class="a2n-welcome__wrapper">
                    <h2>My Orders</h2>
                </div>
                <div>
                    <div class="a2n-billing_section">
                        <div class="a2n-table_section">
                            <style>
                                button#load-more-orders {
                                    color: #fff !important;
                                    display: block;
                                    background: #48bcaf !important;
                                    padding: 14px 30px;
                                    border-radius: 4px;
                                    transition: all 0.3s ease;
                                    font-size: 16px;
                                    border: none;
                                    margin-top: 10px;
                                    cursor: pointer;
                                }
                            </style>

                            <table class="a2n-table" id="order-table">
                                <thead>
                                    <tr>
                                        <th scope="col">Orders ID</th>
                                        <th scope="col">Details</th>
                                        <th scope="col">Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <?php

                                    // Cache customer orders for better performance
                                    // $user_id = get_current_user_id();
                                    $paged = 1; // Initial page
                                    $posts_per_page = 1;

                                    $transient_key = 'customer_orders_' . $user_id . '_page_' . $paged;
                                    // delete_transient($transient_key);
                                    // Try fetching from cache first
                                    $customer_orders = get_transient($transient_key);

                                    // var_dump($customer_orders);

                                    if (false === $customer_orders) {
                                        // Query only a limited number of posts per page
                                        $posts_per_page = 1; // Adjust this based on how many records you want to display per page
                                        $paged = (get_query_var('page')) ? get_query_var('page') : 1;

                                        // Use a lighter query to fetch orders
                                        $args = array(
                                            'meta_key' => '_customer_user',
                                            'meta_value' => $user_id,
                                            'post_type' => wc_get_order_types('view-orders'),
                                            'posts_per_page' => $posts_per_page,
                                            'paged' => $paged,
                                            'post_status' => array_keys(wc_get_order_statuses('Completed', 'Order status', 'woocommerce')),
                                            'fields' => 'ids', // Fetch only the order IDs to reduce memory usage
                                        );

                                        $customer_orders = get_posts($args);

                                        // Cache the result to avoid querying again
                                        //set_transient($transient_key, $customer_orders, 12 * HOUR_IN_SECONDS); // Cached for 12 hours
                                        set_transient($transient_key, $customer_orders, MINUTE_IN_SECONDS);
                                    }

                                    if (is_array($customer_orders) && !empty($customer_orders)) {
                                        $i = 1;

                                        foreach ($customer_orders as $order_id) {
                                            $order = wc_get_order($order_id); // Fetch order details only once
                                            if (!$order) {
                                                continue; // Skip if no order found
                                            }

                                            // Get common order details
                                            $orders_id = $order->get_id();
                                            $status = $order->get_status();
                                            $date_created = $order->get_date_created()->date('d/m/Y - H:i');
                                            $payment_method = $order->get_payment_method_title();
                                            $order_total = $order->get_formatted_order_total();
                                            $items = $order->get_items();

                                            // Loop through items within the order
                                            foreach ($items as $item) {
                                                $product_name = $item->get_name();
                                                $product = $item->get_product();
                                                $product_price = wc_price($item->get_total());


                                                // Output the HTML
                                                echo '
														<tr>
															<th scope="col">#' . esc_html($orders_id) . '</th>
															<th scope="col">' . esc_html($product_name) . '</th>
															<th scope="col">' . esc_html($date_created) . '</th>
															<th scope="col"><span class="btnforstatus">' . esc_html($status) . '</span></th>
															<th scope="col">' . $product_price . '</th>
														</tr>';

                                                $i++;
                                            }

                                            // Output total for the order
                                            echo '<tr>
															<th colspan="5" style="text-align:right;">Total Amount (With VAT):</th>
															<th>' . $order_total . '</th>
														</tr>';
                                        }
                                    } else {
                                        echo '<tr><td colspan="6">No orders found.</td></tr>';
                                    }





                                    ?>
                                </tbody>
                                <tfoot>
                                    <?php
                                    // Output pagination links
                                    //$total_pages = ceil(wc_get_customer_order_count($user_id) / $posts_per_page);
                                    // $total_orders = 12;
                                    $total_orders = wc_get_customer_order_count($user_id);
                                    $posts_per_page = 1;
                                    $total_pages = ceil($total_orders / $posts_per_page);

                                    // Display the "Load More" button only if there are more orders to load
                                    if ($total_pages > 1) {
                                        echo '<tr><td colspan="6"><button id="load-more-orders" data-page="2">See More Orders</button></td></tr>';
                                    }
                                    ?>
                                </tfoot>
                            </table>
                            <script>
                                jQuery(document).ready(function($) {
                                    var currentPage = 1;
                                    var userID = <?php echo $user_id; ?>;

                                    // Handle Load More button click
                                    $('#load-more-orders').on('click', function(e) {
                                        e.preventDefault();
                                        currentPage++;
                                        $.ajax({
                                            url: ajaxurl,
                                            type: 'POST',
                                            data: {
                                                action: 'fetch_customer_orders',
                                                paged: currentPage,
                                                userId: userID
                                            },
                                            beforeSend: function() {
                                                $('#load-more-orders').text('Loading...'); // Optional loading text
                                            },
                                            success: function(response) {
                                                console.log(response);
                                                if (response.success) {

                                                    // Append the new orders to the existing ones
                                                    $('#order-table tbody').append(response.data.html);

                                                    // Check if there are more pages to load
                                                    if (response.data.has_more) {
                                                        $('#load-more-orders').text('Load More Order'); // Reset button text
                                                    } else {
                                                        $('#load-more-orders').remove(); // Remove the button if no more pages
                                                    }
                                                } else {
                                                    $('#order-table tbody').append('<tr><td colspan="6">No more orders found.</td></tr>');
                                                    $('#load-more-orders').remove(); // Remove the button if no more orders
                                                }
                                            },
                                            error: function() {
                                                alert('An error occurred while processing your request.');
                                                $('#load-more-orders').text('Load More');
                                            }
                                        });
                                    });
                                });
                            </script>
                        </div>
                    </div>
                </div>

            </div>
            <!-- Orders Tab End  -->

            <!-- Student card Tab Start  -->
            <div id="my_student_card" class="a2n_dash_tabs">
                <div class="a2n-welcome__wrapper">
                    <h2>Student ID Card</h2>
                </div>
                <div class="forms_part"><?php echo do_shortcode('[gravityform id="5" title="false"]'); ?></div>
            </div>
            <!-- Student card Tab End  -->

            <!-- Support Tab Start  -->
            <div id="my_support" class="a2n_dash_tabs">
                <div class="a2n-welcome__wrapper">
                    <h2>Create a Ticket</h2>
                </div>
                <div class="forms_part"><?php echo do_shortcode('[gravityform id="51" title="false"]'); ?></div>
            </div>
            <!-- Support Tab End  -->
        </main>
    </div>
    <!-- Dashboard Area End  -->
</section>
<style>
    /* ajax search css start  */
    #a2n-loading {
        display: none;
        z-index: 9;
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
    }

    .a2n-suggestion-box {
        position: absolute;
        background: #ffffff;
        width: 100%;
        padding: 15px;
        border-radius: 8px;
        box-shadow: rgb(0 0 0 / 16%) 0 1px 4px;
        display: none;
        z-index: 999999;
        top: 64px;
    }

    .a2n-suggestion-box hr {
        margin: 10px 0;
        border: 0;
        border-top: 1px solid #eee;
    }

    #a2n-search-suggestion .foy-course-list {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    #a2n-search-suggestion .foy-course-list a {
        display: inline-block;
        padding: 0;
        color: #474d5c;
        font-family: "Roboto", sans-serif;
        font-size: 18px;
        font-weight: 500;
        line-height: normal;
        transition: all 0.3s ease;
    }

    #a2n-search-suggestion .foy-course-list img {
        width: 50px;
        margin: 0;
    }

    /* ajax search css end  */
</style>
<script type="text/javascript">
    jQuery(document).ready(function($) {
        function nxtSearchFunction() {
            const navSearch = $(this).closest('#a2n-search-suggestion');
            const suggestionBox = navSearch.find('.a2n-suggestion-box');
            let loader = navSearch.find('#a2n-loading');
            const keyword = $(this).val();
            if (keyword.length < 4) {
                if (suggestionBox) {
                    suggestionBox.remove();
                }
                if (loader) {
                    loader.remove();
                }
            } else {
                if (!suggestionBox.length) {
                    navSearch.append('<ul class="a2n-suggestion-box" id="a2n-suggestion-box"><!-- course suggestion --></ul>');
                }
                if (!loader.length) {
                    const input = navSearch.find('input[name="s"]');
                    loader = $('<div>', {
                            id: 'a2n-loading',
                            class: 'spinner-border',
                            role: 'status'
                        })
                        .html('<img src="/wp-content/themes/wplmsblankchildhtheme/assets/dash/images/dashboard/loader.webp" alt="search loader">');
                    input.after(loader);
                }
                loader.show();
                $.ajax({
                    url: ajaxurl,
                    type: 'get',
                    data: {
                        action: 'data_fetch_advance',
                        keyword: keyword
                    },
                    success: function(data) {
                        const suggestionBox = navSearch.find('.a2n-suggestion-box');
                        suggestionBox.html(data).show();
                        loader.hide();
                    }
                });
            }
        }
        $('#a2n-search-suggestion input[name="s"]').on('keyup', nxtSearchFunction);
    });
    document.addEventListener('click', function(event) {
        var suggestionBox = document.querySelector('.a2n-suggestion-box');
        if (suggestionBox) {
            let loader = document.querySelector('#a2n-loading');
            var isClickedInside = suggestionBox.contains(event.target);
            if (!isClickedInside) {
                suggestionBox.remove();
                if (loader) {
                    loader.remove();
                }
            }
        }
    });
</script>